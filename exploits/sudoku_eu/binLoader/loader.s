	.set	noreorder

	lui	$a0, 0x08A9
	jal	0x0889D230	# sceUtilitySavedataInitStart
	ori	$a0, $a0, 0x5DC0

	bltz	$v0, $sceKernelExitGameWithStatus
	li	$s1, 1		# SCE_UTILITY_STATUS_INITIALIZE

	jal	0x0889CDD0	# sceKernelGetThreadId
	li	$s2, 2		# SCE_UTILITY_STATUS_RUNNING

	move	$s0, $v0
	move	$a0, $v0
	jal	0x0889CDC8	# sceKernelChangeThreadPriority
	li	$a1, 111

	b	$loopSavedataWait
	li	$s3, 3		# SCE_UTILITY_STATUS_FINISHED

$loopSavedataUpdate:
	jal	0x0889D240	# sceUtilitySavedataUpdate
	li	$a0, 1
$loopSavedataWait:
	jal	0x0889D248	# sceUtilitySavedataGetStatus
	nop
	bltzl	$v0, $sceKernelExitGameWithStatus
	nop
	beql	$v0, $s1, $loopSavedataWait
	nop
	beql	$v0, $s2, $loopSavedataUpdate
	nop
	bnel	$v0, $s3, $break
	move	$a0, $s0

	jal	0x0889D238	# sceUtilitySavedataShutdownStart
	nop

	move	$a0, $s0
$break:
	jal	0x0889CDC8	# sceKernelChangeThreadPriority
	li	$a1, 16

	jal	0x0889CD80	# sceKernelDcacheWritebackAll
	lui	$s0, 0x0900
	lui	$s1, 0x0A00
$loopCache:
	addiu	$s1, $s1, 64
	sltu	$a0, $s1, $s2
	bnez	$a0, $loopCache
	cache	0x14, 0($s1)

	j	0x09000000
	nop

$sceKernelExitGameWithStatus:
	j	0x0889CEF0	# sceKernelExitGameWithStatus
	nop
